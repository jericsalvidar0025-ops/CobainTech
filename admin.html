<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>CobainTech Admin</title>
<link rel="stylesheet" href="style.css">

<style>
/* ----------------------------------------------------------
   GLOBAL LAYOUT
-----------------------------------------------------------*/
body {
  margin: 0;
  font-family: 'Segoe UI', Roboto, sans-serif;
  background: #0c0d0f;
  color: #e5e5e5;
}

button { cursor: pointer; }
a { color: inherit; text-decoration: none; }

.container {
  display: flex;
  height: 100vh;
  overflow: hidden;
}

/* ----------------------------------------------------------
   SIDEBAR
-----------------------------------------------------------*/
.sidebar {
  width: 240px;
  background: #111214;
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  border-right: 1px solid #1b1c1f;
}

.sidebar button {
  padding: 12px;
  background: #141518;
  border: 1px solid #1c1d21;
  border-radius: 10px;
  color: #d8d8d8;
  font-size: 1rem;
  text-align: left;
  transition: 0.15s;
}

.sidebar button:hover {
  background: #1b1c20;
}

.sidebar button.active {
  background: #2f80ed;
  border-color: #2f80ed;
  color: white;
}

/* ----------------------------------------------------------
   CONTENT WRAPPER + SECTION HEADERS
-----------------------------------------------------------*/
.content {
  flex: 1;
  padding: 22px;
  overflow-y: auto;
}

.section-header {
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid #1b1c1f;
}

.section-header h2 {
  margin: 0;
  font-size: 1.6rem;
  font-weight: 700;
}

/* ----------------------------------------------------------
   CARDS
-----------------------------------------------------------*/
.card {
  background: #111214;
  border-radius: 12px;
  padding: 18px;
  border: 1px solid #1b1c1f;
  margin-bottom: 20px;
}

/* ----------------------------------------------------------
   TABLES
-----------------------------------------------------------*/
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 12px;
}

th, td {
  padding: 12px;
  text-align: left;
}

th {
  background: #1a1b1f;
  font-weight: 600;
}

tr:nth-child(even) {
  background: #15161a;
}

/* ----------------------------------------------------------
   CHAT PANEL — DISCORD STYLE
-----------------------------------------------------------*/
#chat-wrapper {
  display: flex;
  gap: 14px;
  height: 620px;
}

/* left panel — user list */
#chat-users {
  width: 300px;
  background: #0e0f12;
  border-radius: 12px;
  padding: 10px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.user-btn {
  display: flex;
  align-items: center;
  padding: 10px;
  gap: 12px;
  border-radius: 8px;
  background: #111214;
  border: 1px solid #1b1c1f;
  transition: 0.15s;
}

.user-btn:hover {
  background: #1a1b1f;
}

.user-avatar {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: #2f80ed;
  color: white;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
}

.user-meta { flex: 1; }
.user-name { font-weight: 700; }
.user-last {
  font-size: .8rem;
  color: #9ea0a3;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.user-badge {
  background: #e74c3c;
  padding: 4px 8px;
  border-radius: 20px;
  color: white;
  font-size: .75rem;
}

/* right panel — chat */
#chat-panel {
  flex: 1;
  background: #0e0f12;
  border-radius: 12px;
  padding: 12px;
  display: flex;
  flex-direction: column;
}

#chat-panel-header {
  padding: 12px;
  border-bottom: 1px solid #1b1c1f;
  margin-bottom: 12px;
  display: flex;
  gap: 12px;
  align-items: center;
}

#chat-admin-messages {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.bubble-admin {
  align-self: flex-end;
  background: #2f80ed;
  color: white;
  padding: 10px 14px;
  border-radius: 12px;
  max-width: 70%;
}

.bubble-customer {
  align-self: flex-start;
  background: #1a1b1f;
  border: 1px solid #242529;
  color: #eee;
  padding: 10px 14px;
  border-radius: 12px;
  max-width: 70%;
}

.msg-time {
  font-size: .75rem;
  color: #8b8d90;
  margin-top: 4px;
  align-self: flex-end;
}

/* chat input row */
#chat-input-row {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}

#admin-chat-input {
  flex: 1;
  padding: 10px 12px;
  background: #0d0e11;
  border: 1px solid #1b1c1f;
  border-radius: 20px;
  color: white;
}

.btn {
  padding: 10px 16px;
  border-radius: 8px;
  border: none;
  color: white;
}

.btn.primary { background: #2f80ed; }
.btn.ghost { background: #1b1c1f; }
</style>
</head>

<body>

<div class="container">

  <!-- SIDEBAR -->
  <nav class="sidebar">
    <button class="active" onclick="showTab('products')">Products</button>
    <button onclick="showTab('orders')">Orders</button>
    <button onclick="showTab('sales')">Sales</button>
    <button onclick="showTab('settings')">Settings</button>
    <button onclick="showTab('chat')">Chat</button>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="content">

    <!-- PRODUCTS TAB -->
    <section id="tab-products">
      <div class="section-header">
        <h2>Products</h2>
      </div>

      <div class="card">
        <button onclick="showAddProduct()" class="btn primary">Add Product</button>
        <div id="product-form-area" style="display:none; margin-top:14px;">
          <h3 id="product-form-title">Add Product</h3>
          <form id="product-form" onsubmit="saveProduct(event)">
            <input type="hidden" id="p-id">
            <label>Title <input id="p-title" required></label>
            <label>Price <input type="number" id="p-price" required></label>
            <label>Stock <input type="number" id="p-stock" required></label>
            <label>Category <input id="p-category" required></label>
            <label>Description <input id="p-desc"></label>
            <label>Image URL <input id="p-image-url"></label>

            <div style="display:flex;gap:10px;">
              <button class="btn primary" type="submit">Save</button>
              <button class="btn ghost" type="button" onclick="hideProductForm()">Cancel</button>
            </div>
          </form>
        </div>
      </div>

      <input id="admin-search" placeholder="Search products..." oninput="renderAdminProducts()" style="padding:10px;border-radius:8px;border:1px solid #1b1c1f;background:#0d0e10;color:#fff;width:100%;">

      <div id="admin-product-list" class="product-grid"></div>
    </section>



    <!-- ORDERS TAB -->
    <section id="tab-orders" style="display:none;">
      <div class="section-header">
        <h2>Orders</h2>
      </div>

      <div class="card">
        <table>
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Items</th>
              <th>Total</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="admin-orders"></tbody>
        </table>
      </div>
    </section>



    <!-- SALES TAB -->
    <section id="tab-sales" style="display:none;">
      <div class="section-header">
        <h2>Sales Overview</h2>
      </div>

      <div class="card">
        <div class="sales-metrics" style="display:flex;gap:20px;flex-wrap:wrap;">
          <div class="metric">
            <h3>Total Revenue</h3>
            <p id="total-revenue">₱0</p>
          </div>
          <div class="metric">
            <h3>Total Orders</h3>
            <p id="total-orders">0</p>
          </div>
        </div>

        <canvas id="salesChart" height="230"></canvas>
      </div>
    </section>



    <!-- SETTINGS TAB -->
    <section id="tab-settings" style="display:none;">
      <div class="section-header">
        <h2>Settings</h2>
      </div>

      <div class="card">
        <form id="settings-form" onsubmit="saveSettings(event)">
          <label>Store Name <input id="store-name"></label>
          <label>Store Logo <input id="store-logo"></label>
          <label>Contact Email <input id="store-email"></label>
          <label>Phone <input id="store-phone"></label>
          <button class="btn primary" type="submit">Save Settings</button>
        </form>
      </div>
    </section>



    <!-- CHAT TAB -->
    <section id="tab-chat" style="display:none;">
      <div class="section-header">
        <h2>Customer Chat</h2>
      </div>

      <div id="chat-wrapper">

        <!-- LEFT: USER LIST -->
        <div id="chat-users">
          <div style="color:#888;text-align:center;padding:20px;">Loading users...</div>
        </div>

        <!-- RIGHT: CHAT PANEL -->
        <div id="chat-panel">
          <div id="chat-panel-header">
            <div id="chat-user-info">
              <div id="chat-with" style="font-weight:700;font-size:1.2rem;">Select a customer</div>
              <div id="chat-last-seen" style="font-size:.8rem;color:#8b8d90;">—</div>
            </div>
          </div>

          <div id="chat-admin-messages">
            <div style="color:#888;">No conversation selected.</div>
          </div>

          <div id="chat-input-row">
            <input id="admin-chat-input" placeholder="Type a message...">
            <button class="btn primary" onclick="adminSendChat()">Send</button>
          </div>

          <div style="margin-top:10px;display:flex;gap:8px;">
            <button class="btn ghost" onclick="insertQuickReply('Hello! How can I help you today?')">Hello</button>
            <button class="btn ghost" onclick="insertQuickReply('Your order is being processed.')">Order Update</button>
            <button class="btn ghost" onclick="insertQuickReply('Can you send a picture of the issue?')">Ask Photo</button>
          </div>
        </div>

      </div>
    </section>

  </main>
</div>


<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="firebase-config.js"></script>
<script src="script.js"></script>

<script>
function showTab(tab){
  ['products','orders','sales','settings','chat'].forEach(t=>{
    document.getElementById('tab-'+t).style.display = (t === tab) ? 'block' : 'none';
    document.querySelectorAll('.sidebar button')
      .forEach(btn => btn.classList.toggle('active', btn.textContent.toLowerCase() === t));
  });

  if(tab === 'settings') loadSettings();
}
</script>

</body>
</html>
