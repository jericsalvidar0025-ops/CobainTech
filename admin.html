<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Panel — CobainTech</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body { background:#0b0c0e; color:#eee; font-family: 'Segoe UI', sans-serif; margin:0; padding:0; }
    header, footer { background:#111; padding:12px 20px; }
    header .brand-link { color:#fff; text-decoration:none; font-size:1.2rem; font-weight:bold; }
    header nav a, header nav button { margin-left:12px; }
    main { padding:20px; max-width:1200px; margin:auto; }
    h1 { margin-bottom:20px; }
    .section { margin-bottom:40px; }
    
    /* Admin product table */
    #admin-product-list {
      display:grid;
      grid-template-columns: repeat(auto-fill,minmax(250px,1fr));
      gap:16px;
    }
    .admin-item {
      background:#1a1b1f;
      padding:16px;
      border-radius:12px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      gap:8px;
      box-shadow:0 4px 12px rgba(0,0,0,0.4);
    }
    .admin-item div { font-size:0.95rem; }
    .admin-item button { font-size:0.85rem; padding:6px 10px; border-radius:6px; cursor:pointer; }
    .admin-item button:hover { opacity:0.9; }

    /* Product form */
    #product-form-area {
      background:#1a1b1f;
      padding:20px;
      border-radius:12px;
      margin-bottom:30px;
      display:none;
      box-shadow:0 6px 20px rgba(0,0,0,0.5);
    }
    #product-form label { display:block; margin-bottom:12px; }
    #product-form input, #product-form textarea, #product-form select {
      width:100%; padding:8px; border-radius:6px; border:1px solid #333; background:#111; color:#eee;
      margin-top:4px;
    }
    #product-form button { margin-top:12px; }

    /* Admin orders table */
    table { width:100%; border-collapse:collapse; margin-top:16px; }
    th, td { padding:12px 8px; text-align:left; }
    th { background:#1a1b1f; color:#fff; font-weight:600; }
    tr:nth-child(even) { background:#111; }
    tr:hover { background:#222; }
    td button { padding:6px 10px; font-size:0.85rem; border-radius:6px; }

    .status-Pending { color:orange; font-weight:bold; }
    .status-Processing { color:#3498db; font-weight:bold; }
    .status-Shipped { color:purple; font-weight:bold; }
    .status-Delivered { color:green; font-weight:bold; }

    /* Buttons */
    .btn { padding:6px 12px; border:none; border-radius:6px; cursor:pointer; font-weight:500; }
    .btn.primary { background:#3498db; color:#fff; }
    .btn.ghost { background:transparent; color:#fff; border:1px solid #555; }
    .btn.small { font-size:0.85rem; padding:4px 8px; }

    /* Responsive tweaks */
    @media(max-width:768px){
      #admin-product-list { grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <div class="brand">
        <a href="index.html" class="brand-link">CobainTech Admin</a>
      </div>
      <nav class="actions">
        <span id="welcome-user-top" class="welcome-user"></span>
        <button class="btn" onclick="auth.signOut()">Logout</button>
      </nav>
    </div>
  </header>

  <main>
    <h1>Admin Dashboard</h1>

    <!-- Product management -->
    <section class="section">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
        <h2>Products</h2>
        <button class="btn primary" onclick="showAddProduct()">Add Product</button>
      </div>

      <!-- Search -->
      <input id="admin-search" type="text" placeholder="Search products..." style="width:100%; padding:8px; margin-bottom:16px; border-radius:6px; border:1px solid #333; background:#111; color:#eee;" />

      <!-- Product form -->
      <div id="product-form-area">
        <h3 id="product-form-title">Add Product</h3>
        <form id="product-form" onsubmit="return saveProduct(event)">
          <input type="hidden" id="p-id" />
          <label>Title<input id="p-title" required /></label>
          <label>Price<input type="number" id="p-price" required /></label>
          <label>Stock<input type="number" id="p-stock" required /></label>
          <label>Category<input id="p-category" required /></label>
          <label>Description<textarea id="p-desc"></textarea></label>
          <label>Image URL<input id="p-image-url" /></label>
          <button type="submit" class="btn primary">Save</button>
          <button type="button" class="btn ghost" onclick="hideProductForm()">Cancel</button>
        </form>
      </div>

      <div id="admin-product-list">
        <!-- Products injected here -->
      </div>
    </section>

    <!-- Orders management -->
    <section class="section">
      <h2>Orders</h2>
      <table>
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Customer</th>
            <th>Items</th>
            <th>Total</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="admin-orders">
          <!-- Orders injected here -->
        </tbody>
      </table>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div>© <span id="year"></span> CobainTech</div>
    </div>
  </footer>

  <!-- Firebase SDKs (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

  <script src="firebase-config.js"></script>
  <script src="script.js"></script>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // Admin product search
    const searchInput = document.getElementById('admin-search');
    if(searchInput) searchInput.addEventListener('input', () => renderAdminProducts());

    // Bind welcome user
    auth.onAuthStateChanged(user => {
      if(user){
        const welcome = document.getElementById('welcome-user-top');
        usersRef().doc(user.uid).get().then(doc=>{
          if(doc.exists) welcome.textContent = `Hi, ${doc.data().username}`;
        });
      }
    });

    // Initialize admin
    window.addEventListener('load', () => initAdmin());
  </script>
</body>
</html>
